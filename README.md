## Запуск

### Начальное развертывание

Установка зависимостей
```bash
yarn install
```

Сборка приложения
```bash
yarn build
```

Для инициализации приложения внутри CRM необходимо выполнить его сборку (```yarn build```), а затем предоставить html страницу с подключенными скриптами сборки в качестве значения ```entrypoint```, а так же файл стилей в качестве значения ```stylesheet``` объекта конфигурации.

В данном примере есть [файл сервера](https://github.com/retailcrm/core-ui-extensions-examples/blob/master/server.mjs), который отдает необходимые ресурсы и endpoint-ы для обработки HTTP-вызовов. 
После сборки приложения достаточно его запустить с помощью команды ```node server.mjs```.

После этого, на странице заказа в CRM достаточно вызвать в консоли браузера, чтобы инициализировать
один из модулей выше (порядок сохранен):

## Регистрация как интеграционного модуля в аккаунте RetailCRM

Собрав модуль, вы можете инициализировать его не через консоль браузера, а как интеграционный модуль в аккаунте RetailCRM.

Для этого вам необходимо внести информацию о модуле в файл `cases.json`:
* `uuid` — уникальный идентификатор модуля (произвольный)
* `name` — символьный код модуля (должен соответствовать названию папки сборки модуля в `dist/`)
* `targets` — точки встраивания
* `entrypoint` — относительный путь к js-файлу, как указано в ключе `dist/manifest.json`
* `stylesheet` — относительный путь к css-файлу, как указано в ключе `dist/manifest.json`, если у модуля есть стили

После чего выполнить:
```bash
make register
```

При вызове команды `make register` требуется интерактивно указать:
* адрес аккаунта RetailCRM, например `https://demo.retailcrm.ru`
* API-ключ для работы с REST API аккаунта
* название модуля (как указано в `cases.json`), например `yandexMap`
* базовый адрес модуля, например `https://my-module.tech` — это может быть адрес прокси (аля ngrok), который проксирует запросы на ваш локальный сервер

## Сборка архива

Перед сборкой архива выполните сборку модуля с помощью `make build` или `yarn build`.

После этого выполните:
```bash
make zip-archive
```

При вызове команды `make zip-archive` требуется интерактивно указать:
* название папки со сборкой модуля из `dist/`
* версию модуля
* список target-ов, в которые будет встраиваться модуль, через запятую

На снове введенных данных будет сгенерирован `manifest.json` и создан архив с модулем в папке `dist/`.
